<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
<title>Atomy: The Language</title>
<link rel="stylesheet" type="text/css" href="public/doodle.css">
<script type="text/javascript" src="public/jquery.js"></script><script type="text/javascript" src="public/jquery.hotkeys.js"></script><script type="text/javascript" src="public/tags.js"></script><script type="text/javascript" src="public/main.js"></script><link rel="stylesheet" type="text/css" href="public/highlight.css">
</head>
<body>
<div id="main"><div id="content"><div class="section">
<h1 class="section_header">Atomy: The Language</h1>
<div class="section" id="section_syntax">
<h2 class="section_header">Syntax</h2>
<div class="section" id="section_general-rules">
<h3 class="section_header">General Rules</h3>
<p>Atomy is whitespace-sensitive. Operators must be surrounded by whitespace,   and indentation provides hints to the parser when you don't want to use      commas. For example, <code><span class="n">foo-bar</span></code> is an identifier, while <code><span class="n">foo</span><span class="t"> </span><span class="o">-</span><span class="t"> </span><span class="n">bar</span></code> is  subtraction.</p>
<p>Requiring whitespace around operators enables the use of more symbols in     identifier names, allowing pleasant conventions like question-marks (e.g.    <code><span class="n">empty?</span></code>) and exclamation points (e.g. <code><span class="n">do-something-destructive!</span></code>)    for indicating the behaviour of a method or variable.</p>
<p>Atomy's whitespace indentation rules are similar to Haskell's - they are     not as strict as Python's, you just increase the spacing amount to indicate  continuing the previous line, and continue that indentation amount to        indicate continuing the current "block" of code.</p>
<p>Using significant whitespace, this block:</p>
<pre class="highlight"><span class="t"> </span><span class="s">"</span><span class="s">hi</span><span class="s">"</span><span class="t"> </span><span class="n">print</span><span class="t">
      </span><span class="n">goodbye</span><span class="t">
      </span><span class="mi">2</span><span class="t"> </span><span class="o">+</span><span class="t"> </span><span class="mi">2</span><span class="t"> </span><span class="n">call</span></pre>
<p>is equivalent to:</p>
<pre class="highlight"><span class="t"> </span><span class="s">"</span><span class="s">hi</span><span class="s">"</span><span class="t"> </span><span class="n">print</span><span class="p">,</span><span class="t"> </span><span class="n">goodbye</span><span class="p">,</span><span class="t"> </span><span class="mi">2</span><span class="t"> </span><span class="o">+</span><span class="t"> </span><span class="mi">2</span><span class="t"> </span><span class="n">call</span></pre>
<p>With these simple line-continuing rules in place, you can spread a single    chain of messages across multiple lines:</p>
<pre class="highlight"><span class="n">something</span><span class="t">
  </span><span class="n">foo</span><span class="t">
  </span><span class="n">sqrt</span></pre>
<p>Which is parsed as:</p>
<pre class="highlight"><span class="n">something</span><span class="t"> </span><span class="n">foo</span><span class="t"> </span><span class="n">sqrt</span></pre>
<p>The same rules apply to operators, which will skip any whitespace to get to  the right-hand side of the expression.</p>
<pre class="highlight"><span class="n">foo</span><span class="t"> </span><span class="o">=</span><span class="t">
  </span><span class="mi">1</span><span class="t"> </span><span class="o">+</span><span class="t">
    </span><span class="mi">2</span><span class="t"> </span><span class="o">*</span><span class="t">
      </span><span class="mi">3</span></pre>
<p>Which is parsed as:</p>
<pre class="highlight"><span class="n">foo</span><span class="t"> </span><span class="o">=</span><span class="t"> </span><span class="mi">1</span><span class="t"> </span><span class="o">+</span><span class="t"> </span><span class="mi">2</span><span class="t"> </span><span class="o">*</span><span class="t"> </span><span class="mi">3</span></pre>
<p>Two spaces for indentation is recommended.</p>
</div>
<div class="section" id="section_comments">
<h3 class="section_header">Comments</h3>
<p>Atomy borrows its comment syntax from Haskell: <code>--</code> for line comments,  and <code>{- -}</code> for block comments (which can be nested).</p>
<pre class="highlight"><span class="mi">1</span><span class="t"> </span><span class="c1">-- The number, "one."</span><span class="t">
</span><span class="p">(</span><span class="cm">{-</span><span class="cm"> Blah blah blah, </span><span class="cm">{-</span><span class="cm"> yo dawg </span><span class="cm">-}</span><span class="cm">, fizz buzz! </span><span class="cm">-}</span><span class="t"> </span><span class="s">"</span><span class="s">foo</span><span class="s">"</span><span class="p">)</span><span class="t"> </span><span class="n">print</span></pre>
</div>
<div class="section" id="section_literals-syntax">
<h3 class="section_header">Literals</h3>
<dl><dt>integers</dt>
<dd><p><code><span class="mi">1</span></code>, <code><span class="mi">-1</span></code>, <code><span class="mh">0xdeadbeef</span></code>, <code><span class="mo">0o644</span></code>, <code><span class="mh">-0x10</span></code>, <code><span class="mo">-0o10</span></code> ...</p></dd>

<dt>doubles</dt>
<dd><p><code><span class="mf">1.0</span></code>, <code><span class="mf">-1.5</span></code>, <code><span class="mf">1.5e10</span></code>, <code><span class="mf">1.4e-3</span></code>, <code><span class="mf">-1.4e4</span></code>...</p></dd>

<dt>strings</dt>
<dd>
<p><code><span class="s">"</span><span class="s">"</span></code>, <code><span class="s">"</span><span class="s">foo</span><span class="s">"</span></code>, <code><span class="s">"</span><span class="s">fizz </span><span class="se">\</span><span class="se">"</span><span class="s">buzz</span><span class="se">\</span><span class="se">"</span><span class="s">"</span></code></p>
<p>Escape codes supported (in addition to numeric escapes):</p>
<pre class="verbatim">ascii-2:
  \b \t \n \v \f \r \SO \SI \EM \FS \GS \RS \US &#9251; (space)
  \BS \HT \LF \VT \FF \CR \SO \SI \EM \BS \GS \RS \US \SP

ascii-3:
  \NUL \SOH \STX \ETX \EOT \ENQ \ACK \a \DLE \DC1 \DC2
  \DC3 \DC4 \NAK \SYN \ETB \CAN \SUB \ESC \DEL</pre>
<p>When a string is used as a message, you get a "macro-quote." The             receiver should be a variable or send, which names the macro-quoter. If      it's a send, its arguments will be used as flags.</p>
</dd>

<dt>pseudo variables</dt>
<dd><p><code><span class="kr">self</span></code>, <code><span class="kc">nil</span></code>, <code><span class="kc">true</span></code>, and <code><span class="kc">false</span></code></p></dd>

<dt>arrays</dt>
<dd><p><code><span class="p">[</span><span class="p">]</span></code>, <code><span class="p">[</span><span class="mi">1</span><span class="p">]</span></code>, <code><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="t"> </span><span class="mi">2</span><span class="p">]</span></code>, <code><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="t"> </span><span class="o">$</span><span class="mi">2</span><span class="p">,</span><span class="t"> </span><span class="s">"</span><span class="s">three</span><span class="s">"</span><span class="p">]</span></code>, ...</p></dd>

<dt>expressions</dt>
<dd><dl><dt>quoted</dt>
<dd>
<p>An apostrophe (<code>'</code>) before an expression "quotes" it, turning           it into an expression literal:</p>
<div class="example">
<p><em>Example:</em></p>
<pre class="highlight"><span class="err">'</span><span class="mi">1</span><span class="t">
</span><span class="ss">'a</span><span class="t">
</span><span class="err">'</span><span class="p">(</span><span class="mi">1</span><span class="t"> </span><span class="o">+</span><span class="t"> </span><span class="mi">1</span><span class="p">)</span><span class="t">
</span><span class="ss">''</span><span class="p">(</span><span class="mi">1</span><span class="t"> </span><span class="o">+</span><span class="t"> </span><span class="n">b</span><span class="p">)</span><span class="t">
</span><span class="err">'</span><span class="t"> </span><span class="n">a</span><span class="t"> </span><span class="o">=</span><span class="t"> </span><span class="mi">1</span><span class="p">,</span><span class="t"> </span><span class="n">a</span><span class="t"> </span><span class="o">+</span><span class="t"> </span><span class="mi">1</span></pre>
</div>
</dd>

<dt>quasiquoted</dt>
<dd>
<p>Atomy supports quasiquotation as seen in most Lisps, most similarly          Clojure. A backquote (<code>`</code>) begins a quasiquote, inside of               which you can use tilde (<code>~</code>) to "unquote."</p>
<p>These can be nested infinitely; unquoting works inside of aggregate          expressions such as lists, blocks, and definitions.</p>
<div class="example">
<p><em>Example:</em></p>
<pre class="interaction"><span class="caret">&gt; </span><span class="err">`</span><span class="mi">1</span><span class="t">
</span><span class="mi">1</span>
<span class="caret">&gt; </span><span class="err">`</span><span class="p">(</span><span class="mi">1</span><span class="t"> </span><span class="o">+</span><span class="t"> </span><span class="o">~</span><span class="p">(</span><span class="mi">2</span><span class="t"> </span><span class="o">+</span><span class="t"> </span><span class="mi">2</span><span class="p">)</span><span class="p">)</span><span class="t">
</span><span class="mi">1</span><span class="t"> </span><span class="o">+</span><span class="t"> </span><span class="mi">4</span>
<span class="caret">&gt; </span><span class="err">``</span><span class="p">(</span><span class="mi">1</span><span class="t"> </span><span class="o">+</span><span class="t"> </span><span class="o">~</span><span class="o">~</span><span class="p">(</span><span class="mi">2</span><span class="t"> </span><span class="o">+</span><span class="t"> </span><span class="mi">2</span><span class="p">)</span><span class="p">)</span><span class="t">
</span><span class="err">`</span><span class="p">(</span><span class="mi">1</span><span class="t"> </span><span class="o">+</span><span class="t"> </span><span class="o">~</span><span class="mi">4</span><span class="p">)</span>
<span class="caret">&gt; </span><span class="err">`</span><span class="t"> </span><span class="n">a</span><span class="t"> </span><span class="o">=</span><span class="t"> </span><span class="o">~</span><span class="p">(</span><span class="mi">2</span><span class="t"> </span><span class="o">+</span><span class="t"> </span><span class="mi">2</span><span class="p">)</span><span class="t">
</span><span class="gr">ERROR: private method ``' called on an instance of Object.</span>
<span class="caret">&gt; </span><span class="err">`</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="t"> </span><span class="mi">2</span><span class="p">,</span><span class="t"> </span><span class="o">~</span><span class="p">(</span><span class="mi">1</span><span class="t"> </span><span class="o">+</span><span class="t"> </span><span class="mi">2</span><span class="p">)</span><span class="p">]</span><span class="t">
</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="t"> </span><span class="mi">2</span><span class="p">,</span><span class="t"> </span><span class="mi">3</span><span class="p">]</span>
</pre>
</div>
<p>Note that unquoting too far signals an <code><span class="vi">@out-of-quote</span><span class="o">:</span></code> error.</p>
<div class="example">
<p><em>Example:</em></p>
<pre class="interaction"><span class="caret">&gt; </span><span class="err">`</span><span class="o">~</span><span class="o">~</span><span class="p">(</span><span class="mi">2</span><span class="t"> </span><span class="o">+</span><span class="t"> </span><span class="mi">2</span><span class="p">)</span><span class="t">
</span><span class="mi">2</span><span class="t"> </span><span class="o">+</span><span class="t"> </span><span class="mi">2</span>
</pre>
</div>
</dd></dl></dd>

<dt>blocks</dt>
<dd>
<p>Blocks come in two forms. One is a simple comma-delimited list of            expressions wrapped in curly braces (<code>{ }</code>), and another form         begins with a colon (<code>:</code>) and optionally ends with a semicolon          (<code>;</code>).</p>
<p>Block parsing is whitespace-aware; see</p>
</dd></dl>
</div>
<div class="section" id="section_dispatch-syntax">
<h3 class="section_header">Dispatch</h3>
<p>Atomy's dispatch is considerably simple: one expression followed by   another, optionally including arguments.</p>
<p>Most of the time, you'll be using a variable as the method name:</p>
<div class="example">
<p><em>Example:</em></p>
<pre class="highlight"><span class="mi">1</span><span class="t"> </span><span class="n">foo</span><span class="t">
 </span><span class="mi">1</span><span class="t"> </span><span class="n">sqrt</span><span class="t"> </span><span class="n">call</span></pre>
</div>
<p>However, you can actually use anything there, as long as it knows how to be used as a message. This is done by defining <code><span class="n">as-message</span><span class="p">(</span><span class="n">send</span><span class="p">)</span></code> for the node, where <code><span class="n">send</span></code> the <code><span class="no">Send</span></code> it's being used in. This method should return a <code><span class="no">Send</span></code> node.</p>
<p>There are currently three other things you can use as a message: a <code><span class="no">List</span></code>, a <code><span class="no">Block</span></code>, and a <code><span class="no">UnarySend</span></code> of <code>$</code>. But feel free to define your own.</p>
<p>When a <code><span class="no">List</span></code> is used as a message, it sends <code>[]</code> with its contents  as the arguments, as in Ruby. Note that this will also give you <code>[]=</code>   for free.</p>
<div class="example">
<p><em>Example:</em></p>
<pre class="interaction"><span class="caret">&gt; </span><span class="n">a</span><span class="t"> </span><span class="o">=</span><span class="t"> </span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="t"> </span><span class="mi">2</span><span class="p">,</span><span class="t"> </span><span class="mi">3</span><span class="p">]</span><span class="t">
</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="t"> </span><span class="mi">2</span><span class="p">,</span><span class="t"> </span><span class="mi">3</span><span class="p">]</span>
<span class="caret">&gt; </span><span class="n">a</span><span class="t"> </span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="t">
</span><span class="mi">2</span>
<span class="caret">&gt; </span><span class="n">a</span><span class="t"> </span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="t"> </span><span class="o">=</span><span class="t"> </span><span class="mi">4</span><span class="t">
</span><span class="mi">4</span>
<span class="caret">&gt; </span><span class="n">a</span><span class="t">
</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="t"> </span><span class="mi">4</span><span class="p">,</span><span class="t"> </span><span class="mi">3</span><span class="p">]</span>
</pre>
</div>
<p>When a <code><span class="no">Block</span></code> is used as a message, it attaches itself as a Ruby-style   proc-arg. When a <code><span class="no">List</span></code> and a <code><span class="no">Block</span></code> are used in combination, the   <code><span class="no">List</span></code> instead acts as the block's arguments.</p>
<div class="example">
<p><em>Example:</em></p>
<pre class="interaction"><span class="caret">&gt; </span><span class="mi">2</span><span class="t"> </span><span class="n">times</span><span class="o">:</span><span class="t"> </span><span class="s">"</span><span class="s">hi</span><span class="s">"</span><span class="t"> </span><span class="n">print</span><span class="t">
</span>hi
hi
<span class="mi">2</span>
<span class="caret">&gt; </span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="t"> </span><span class="mi">2</span><span class="p">,</span><span class="t"> </span><span class="mi">3</span><span class="p">]</span><span class="t"> </span><span class="n">collect</span><span class="t"> </span><span class="p">[</span><span class="n">x</span><span class="p">]</span><span class="o">:</span><span class="t"> </span><span class="n">x</span><span class="t"> </span><span class="o">*</span><span class="t"> </span><span class="mi">2</span><span class="t">
</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="t"> </span><span class="mi">4</span><span class="p">,</span><span class="t"> </span><span class="mi">6</span><span class="p">]</span>
</pre>
</div>
<p>You can also include arguments with the message by following the expression  with parentheses and listing them separated by commas (as in most other   languages).</p>
<div class="example">
<p><em>Example:</em></p>
<pre class="highlight"><span class="mi">1</span><span class="t"> </span><span class="n">foo</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="t"> </span><span class="mi">3</span><span class="p">)</span><span class="t">
</span><span class="p">[</span><span class="n">a</span><span class="p">]</span><span class="t">  </span><span class="n">a</span><span class="t"> </span><span class="o">+</span><span class="t"> </span><span class="mi">1</span><span class="t"> </span><span class="n">call</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span></pre>
</div>
<p>A <code><span class="no">UnarySend</span></code> of <code>$</code> sent to a <code><span class="no">Block</span></code> can be used as syntactic sugar for avoiding parentheses around argument lists; when used as a message, it simply appends the block's contents to the send's arguments.</p>
<div class="example">
<p><em>Example:</em></p>
<pre class="highlight"><span class="mi">1</span><span class="t"> </span><span class="n">foo</span><span class="t"> </span><span class="o">$</span><span class="o">:</span><span class="t"> </span><span class="mi">2</span><span class="p">,</span><span class="t"> </span><span class="mi">3</span></pre>
</div>
<p>If there is no "target" for the message, it is a private message sent to   <code><span class="kr">self</span></code>.</p>
</div>
<div class="section" id="section_macro-syntax">
<h3 class="section_header">macro</h3>
<p>The <code><span class="kr">macro</span></code> keyword is used to define macros; the format is as follows:</p>
<pre class="verbatim">macro(pattern): [expressions ...]
  where
    pattern = a message pattern
    expressions = the macro's body</pre>
</div>
<div class="section" id="section_operator-syntax">
<h3 class="section_header">operator</h3>
<p>You can control how Atomy parses binary operators like <code><span class="o">+</span></code> and <code><span class="o">-</span><span class="o">&gt;</span></code> via the <code><span class="kr">operator</span></code> keyword. The syntax is as follows:</p>
<pre class="verbatim">operator [associativity] [precedence] operators
  where
    associativity = "right" | "left"
    precedence = integer
    operators = operator +</pre>
<p>An omitted associativity implies left, and an omitted precedence implies 5 (the default). One of the two must be provided.</p>
<div class="example">
<p><em>Example:</em></p>
<pre class="highlight"><span class="kr">operator</span><span class="t"> </span><span class="n">right</span><span class="t"> </span><span class="mi">0</span><span class="t"> </span><span class="o">-</span><span class="o">&gt;</span><span class="t">
</span><span class="kr">operator</span><span class="t"> </span><span class="n">right</span><span class="t"> </span><span class="mi">8</span><span class="t"> </span><span class="o">^</span><span class="t">
</span><span class="kr">operator</span><span class="t"> </span><span class="mi">7</span><span class="t"> </span><span class="o">%</span><span class="t"> </span><span class="o">*</span><span class="t"> </span><span class="o">/</span><span class="t">
</span><span class="kr">operator</span><span class="t"> </span><span class="mi">6</span><span class="t"> </span><span class="o">+</span><span class="t"> </span><span class="o">-</span></pre>
</div>
<p>Operator expressions, when evaluated, just return <code><span class="vi">@ok</span></code>.</p>
</div>
</div>
</div></div></div>
<div class="search">
<form action="javascript:void(0)"><input autocomplete="off" type="text" placeholder="Search&hellip;" id="search"></form>
<ul class="search_results"></ul>
</div>
<div id="sidebar">
<h4>On this page:</h4>
<ol class="toc"><li>
<a href="atomy:-the-language.html#section_syntax">Syntax</a><ol>
<li><a href="atomy:-the-language.html#section_general-rules">General Rules</a></li>
<li><a href="atomy:-the-language.html#section_comments">Comments</a></li>
<li><a href="atomy:-the-language.html#section_literals-syntax">Literals</a></li>
<li><a href="atomy:-the-language.html#section_dispatch-syntax">Dispatch</a></li>
<li><a href="atomy:-the-language.html#section_macro-syntax">macro</a></li>
<li><a href="atomy:-the-language.html#section_operator-syntax">operator</a></li>
</ol>
</li></ol>
<h4>Up one level:</h4>
<ol class="toc"><li>
<a href="index.html">Atomy</a><ol>
<li>
<a href="atomy:-the-language.html">Atomy: The Language</a><ol><li>
<a href="atomy:-the-language.html#section_syntax">Syntax</a><ol>
<li><a href="atomy:-the-language.html#section_general-rules">General Rules</a></li>
<li><a href="atomy:-the-language.html#section_comments">Comments</a></li>
<li><a href="atomy:-the-language.html#section_literals-syntax">Literals</a></li>
<li><a href="atomy:-the-language.html#section_dispatch-syntax">Dispatch</a></li>
<li><a href="atomy:-the-language.html#section_macro-syntax">macro</a></li>
<li><a href="atomy:-the-language.html#section_operator-syntax">operator</a></li>
</ol>
</li></ol>
</li>
<li>
<a href="reference.html">Reference</a><ol>
<li>
<a href="concurrency.html">Concurrency</a><ol>
<li><a href="concurrency.html#section_sending-and-receiving">Sending &amp; Receiving</a></li>
<li><a href="concurrency.html#section_spawning">Spawning</a></li>
</ol>
</li>
<li>
<a href="condition-system.html">Condition System</a><ol>
<li><a href="condition-system.html#section_conditions">Conditions</a></li>
<li><a href="condition-system.html#section_handling">Handling</a></li>
<li><a href="condition-system.html#section_signalling">Signalling</a></li>
<li><a href="condition-system.html#section_debuggers">Debuggers</a></li>
</ol>
</li>
<li>
<a href="pretty-printing.html">Pretty-Printing</a><ol>
<li><a href="pretty-printing.html#section_documents">Documents</a></li>
<li><a href="pretty-printing.html#section_constructing">Constructing</a></li>
<li>
<a href="pretty-printing.html#section_helpers">Helpers</a><ol>
<li><a href="pretty-printing.html#section_shortcuts">Shortcuts</a></li>
<li><a href="pretty-printing.html#section_wrapping">Wrapping</a></li>
<li><a href="pretty-printing.html#section_combining">Combining</a></li>
</ol>
</li>
</ol>
</li>
<li>
<a href="input-and-output.html">Input &amp; Output</a><ol>
<li><a href="input-and-output.html#section_output">Output</a></li>
<li><a href="input-and-output.html#section_input">Input</a></li>
</ol>
</li>
<li><a href="the-repl.html">The REPL</a></li>
<li>
<a href="testing-with-therie.html">Testing with Therie</a><ol>
<li><a href="testing-with-therie.html#section_structure">Structure</a></li>
<li><a href="testing-with-therie.html#section_tests">Tests</a></li>
</ol>
</li>
</ol>
</li>
</ol>
</li></ol>
</div>
</body>
</html>
