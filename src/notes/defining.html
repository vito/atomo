<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <title>Defining Methods</title>
    <link rel="stylesheet" type="text/css" href="anatomy.css" />
    <link rel="stylesheet" type="text/css" href="highlight.css" />
  </head>
  <body class="with-sidebar normal">
    <div id="sidebar">
       <h4>On this page:</h4>
<ol class="toc"><li><a href="defining.html#section_variadic">Variadic Roles</a></li><li><a href="defining.html#section_optionals">Optional Roles</a></li><li><a href="defining.html#section_redefining">Redefining Methods</a></li></ol>
<h4>Up one level:</h4><ol class="toc"><li><a href="index.html#section_index">Atomo</a><ol><li><a href="getting-started.html">Getting Started</a><ol><li><a href="getting-started.html#section_.A_quick_introduction_to_.Atomo">A quick introduction to Atomo</a></li><li><a href="getting-started.html#section_.Installation">Installation</a></li><li><a href="getting-started.html#section_.Fire_it_up_">Fire it up!</a></li><li><a href="getting-started.html#section_.Define___.Dispatch">Define & Dispatch</a></li><li><a href="getting-started.html#section_.Lexical_.Scoping_via_.Delegation">Lexical Scoping via Delegation</a></li><li><a href="getting-started.html#section_.Keywords_">Keywords!</a></li><li><a href="getting-started.html#section_.Messages___.Multiple_.Dispatch">Messages & Multiple Dispatch</a></li><li><a href="getting-started.html#section_.Wrapping_.Up">Wrapping Up</a></li></ol></li><li><a href="repl.html">The REPL</a></li><li><a href=".Tutorials.html">Tutorials</a><ol><li><a href="ruby.html">Ruby in Atomo</a></li></ol></li><li><a href="syntax.html">Syntax</a><ol><li><a href="syntax.html#section_.General_.Rules">General Rules</a></li><li><a href="syntax.html#section_guidelines">Indentation Guidelines</a></li><li><a href="syntax.html#section_.Comments">Comments</a></li><li><a href="syntax.html#section_literals-syntax">Literals</a></li><li><a href="syntax.html#section_dispatch-syntax">Dispatch</a></li><li><a href="syntax.html#section_macro-syntax"><code><span class="kr">macro</span></code></a></li><li><a href="syntax.html#section_for-macro-syntax"><code><span class="kr">for-macro</span></code></a></li><li><a href="syntax.html#section_operator-syntax"><code><span class="kr">operator</span></code></a></li></ol></li><li><a href="patterns.html">Patterns</a><ol><li><a href="patterns.html#section_types">Types of Patterns</a></li><li><a href="patterns.html#section_definition-target">A Pattern's Object</a></li><li><a href="patterns.html#section_.Pattern_.Objects">Pattern Objects</a></li></ol></li><li><a href="defining.html">Defining Methods</a><ol><li><a href="defining.html#section_variadic">Variadic Roles</a></li><li><a href="defining.html#section_optionals">Optional Roles</a></li><li><a href="defining.html#section_redefining">Redefining Methods</a></li></ol></li><li><a href="macros.html">Macros!</a><ol><li><a href="macros.html#section_defining-macros">Defining Macros</a></li><li><a href="macros.html#section_macro-environment">Macro Environment</a></li><li><a href="macros.html#section_macro-quotes">Macro Quotes</a></li></ol></li><li><a href="ecosystem.html">The Ecosystem</a><ol><li><a href="ecosystem.html#section_.Eco">Eco</a></li><li><a href="ecosystem.html#section_.Packages">Packages</a></li><li><a href="ecosystem.html#section_.Versions">Versions</a></li></ol></li><li><a href="core.html">Core</a></li><li><a href="dynamic.html">Dynamic Environment</a></li><li><a href="lists.html">Lists</a></li><li><a href="tuples.html">Tuples</a></li><li><a href="strings.html">Strings</a></li><li><a href="regexps.html">Regular Expressions</a></li><li><a href="formatting.html">String Formatting</a><ol><li><a href="formatting.html#section_.Syntax">Syntax</a></li><li><a href="formatting.html#section_.Basic_.Formatters">Basic Formatters</a></li><li><a href="formatting.html#section_.Alignment">Alignment</a></li><li><a href="formatting.html#section_.Pluralization">Pluralization</a></li><li><a href="formatting.html#section_.Case_.Conversion">Case Conversion</a></li><li><a href="formatting.html#section_.Skipping___.Indirection">Skipping & Indirection</a></li><li><a href="formatting.html#section_.Iteration___.Breaking">Iteration & Breaking</a></li><li><a href="formatting.html#section_.Conditionals">Conditionals</a></li><li><a href="formatting.html#section_.Justification">Justification</a></li></ol></li><li><a href="class-objects.html">Class Objects</a><ol><li><a href="class-objects.html#section_.Defining_.Classes">Defining Classes</a></li><li><a href="class-objects.html#section_.Modules___.Mixins">Modules & Mixins</a></li></ol></li><li><a href="blocks.html">Blocks</a></li><li><a href="concurrency.html">Concurrency</a></li><li><a href="conditions.html">Conditions & Restarts</a><ol><li><a href="conditions.html#section_.Signals">Signals</a></li><li><a href="conditions.html#section_.Handlers">Handlers</a></li><li><a href="conditions.html#section_.Traditional_.Exceptions">Traditional Exceptions</a></li></ol></li><li><a href="continuations.html">Continuations</a></li><li><a href="particles.html">Particles</a></li><li><a href="numbers.html">Numbers</a></li><li><a href="boolean.html">Boolean</a><ol><li><a href="boolean.html#section_.Logic">Logic</a></li><li><a href="boolean.html#section_.Control_.Flow">Control Flow</a></li></ol></li><li><a href="comparable.html">Comparable</a></li><li><a href="io.html">Input & Output</a><ol><li><a href="io.html#section_.Parameters">Parameters</a></li></ol></li><li><a href=".Timer.html">Timer</a><ol><li><a href=".Timer.html#section_.The_.Timer_.Object">The Timer Object</a></li><li><a href=".Timer.html#section_.Unit_.Helpers">Unit Helpers</a></li></ol></li><li><a href="association.html">Associations</a></li><li><a href="ordered.html">Ordered Values</a></li><li><a href="enumerable.html">Enumerable</a></li><li><a href="ranges.html">Ranges</a></li><li><a href="pretty.html">Pretty-Printing</a><ol><li><a href="pretty.html#section_.Documents_.From_.Values">Documents From Values</a></li><li><a href="pretty.html#section_.Simple_.Shortcuts">Simple Shortcuts</a></li><li><a href="pretty.html#section_.Wrapping_.Documents">Wrapping Documents</a></li><li><a href="pretty.html#section_.Combining_.Documents">Combining Documents</a></li><li><a href="pretty.html#section_.Rendering">Rendering</a></li></ol></li></ol></li></ol>
    </div>

    <div id="content">
<h1>Defining Methods</h1><p>Atomo packs a lot of information into the <code><span class="o"><a href="core.html#definition_:=:">:=</a></span></code> operator's left-hand side. Not only does it define the name of the method, but it also specifies which object it targets, what patterns it matches, including any variadic roles and optional roles with their default value.</p><p>See also: <a href="patterns.html">Patterns</a>.


</p><div class="section">
  <h2 class="section-header" id="section_variadic">Variadic Roles</h2><p>  </p><p>Atomo uses the <code><span class="n">Tuple</span></code> data type for variadic roles, using the <code><span class="o"><a href="ranges.html#definition_...:">...</a></span><span class="t"> </span><span class="n">foo</span></code> pattern-match. Here, <code><span class="n">foo</span></code> is another pattern, which matches a list. This list contains all of the values provided for the role, which may be zero, one, or any number of values.

</p><div class="example"><p><em>Example:</em></p><pre class="interaction"><span class="caret">&gt;</span> <span class="nf">fizz:</span><span class="t"> </span><span class="p">(</span><span class="o"><a href="ranges.html#definition_...:">...</a></span><span class="t"> </span><span class="p">[</span><span class="p">]</span><span class="p">)</span><span class="t"> </span><span class="o"><a href="core.html#definition_:=:">:=</a></span><span class="t"> </span><span class="nd">@no-args!</span>
<span class="nd">@ok</span>
<span class="caret">&gt;</span> <span class="nf">fizz:</span><span class="t"> </span><span class="p">(</span><span class="o"><a href="ranges.html#definition_...:">...</a></span><span class="t"> </span><span class="n">args</span><span class="p">)</span><span class="t"> </span><span class="o"><a href="core.html#definition_:=:">:=</a></span><span class="t"> </span><span class="nd">@</span><span class="p">(</span><span class="nf">got:</span><span class="t"> </span><span class="n">args</span><span class="p">)</span>
<span class="nd">@ok</span>
<span class="caret">&gt;</span> <span class="nf">fizz:</span><span class="t"> </span><span class="mi">1</span>
<span class="nd">@</span><span class="p">(</span><span class="nf">got:</span><span class="t"> </span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="p">)</span>
<span class="caret">&gt;</span> <span class="nf">fizz:</span><span class="t"> </span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="t"> </span><span class="mi">2</span><span class="p">,</span><span class="t"> </span><span class="mi">3</span><span class="p">)</span>
<span class="nd">@</span><span class="p">(</span><span class="nf">got:</span><span class="t"> </span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="t"> </span><span class="mi">2</span><span class="p">,</span><span class="t"> </span><span class="mi">3</span><span class="p">]</span><span class="p">)</span>
<span class="caret">&gt;</span> <span class="nf">fizz:</span><span class="t"> </span><span class="p">(</span><span class="p">)</span>
<span class="nd">@no-args!</span>
</pre></div><p>Previously, lists would be used for this, but tuples were introduced to make things a bit cleaner. For example, previously you might say &quot;if this role is a list, consider it to be containing any number of values to use, otherwise consider it to be just one value to act on.&quot;



</p><div class="example"><p><em>Example:</em></p><pre class="interaction"><span class="caret">&gt;</span> <span class="nf">foo:</span><span class="t"> </span><span class="p">(</span><span class="nf">xs:</span><span class="t"> </span><span class="n"><a href="lists.html#definition_List">List</a></span><span class="p">)</span><span class="t"> </span><span class="o"><a href="core.html#definition_:=:">:=</a></span><span class="t"> </span><span class="nd">@</span><span class="p">(</span><span class="nf">acting-on-multiple:</span><span class="t"> </span><span class="n">xs</span><span class="p">)</span>
<span class="nd">@ok</span>
<span class="caret">&gt;</span> <span class="nf">foo:</span><span class="t"> </span><span class="n">x</span><span class="t"> </span><span class="o"><a href="core.html#definition_:=:">:=</a></span><span class="t"> </span><span class="nd">@</span><span class="p">(</span><span class="nf">acting-on-one:</span><span class="t"> </span><span class="n">x</span><span class="p">)</span>
<span class="nd">@ok</span>
<span class="caret">&gt;</span> <span class="nf">foo:</span><span class="t"> </span><span class="mi">1</span>
<span class="nd">@</span><span class="p">(</span><span class="nf">acting-on-one:</span><span class="t"> </span><span class="mi">1</span><span class="p">)</span>
<span class="caret">&gt;</span> <span class="nf">foo:</span><span class="t"> </span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="t"> </span><span class="mi">2</span><span class="p">]</span>
<span class="nd">@</span><span class="p">(</span><span class="nf">acting-on-multiple:</span><span class="t"> </span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="t"> </span><span class="mi">2</span><span class="p">]</span><span class="p">)</span>
</pre></div><p>The problem with this comes in when you want to pass a list as one value - you would actually have to place it in another list:

</p><pre class="interaction"><span class="caret">&gt;</span> <span class="nf">foo:</span><span class="t"> </span><span class="p">[</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="t"> </span><span class="mi">2</span><span class="p">]</span><span class="p">]</span>
<span class="nd">@</span><span class="p">(</span><span class="nf">acting-on-multiple:</span><span class="t"> </span><span class="p">[</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="t"> </span><span class="mi">2</span><span class="p">]</span><span class="p">]</span><span class="p">)</span>
</pre><p>So, to avoid that, we'd just use lists for everything - for example, <code><span class="nf"><a href="blocks.html#definition_call:">call:</a></span></code> would take a list of values to send to a block, which was often just one value. This works, but it's noisy.</p><p>This is where tuples come in. You can specify zero arguments with <code><span class="p">(</span><span class="p">)</span></code>, and one value by just sending the value itself, and multiple values by grouping them together as a tuple. There is no ambiguity - you'll never be sending a single &quot;tuple&quot; value, because that's explicitly what they're <em>not</em> used for. All three of these variations - zero, one, or multiple values, are handled by the same method definition.



</p></div>
<div class="section">
  <h2 class="section-header" id="section_optionals">Optional Roles</h2><p>  </p><p>Message patterns may also specify optional roles, via a keyword prefixed with a <code>&amp;</code> (ampersand, read as &quot;with&quot;) paired with a role which represents the default value.

</p><div class="example"><p><em>Example:</em></p><pre class="interaction"><span class="caret">&gt;</span> <span class="p">(</span><span class="nf">x:</span><span class="t"> </span><span class="n"><a href="numbers.html#definition_Double">Double</a></span><span class="p">)</span><span class="t"> </span><span class="n">foo</span><span class="t"> </span><span class="nf">&amp;epsilon:</span><span class="t"> </span><span class="mf">0.01</span><span class="t"> </span><span class="o"><a href="core.html#definition_:=:">:=</a></span><span class="t"> </span><span class="n">x</span><span class="t"> </span><span class="nf">rationalize:</span><span class="t"> </span><span class="n">epsilon</span>
<span class="nd">@ok</span>
<span class="caret">&gt;</span> <span class="mf">10.56</span><span class="t"> </span><span class="n">foo</span>
<span class="m">95/9</span>
<span class="caret">&gt;</span> <span class="mf">10.56</span><span class="t"> </span><span class="n">foo</span><span class="t"> </span><span class="nf">&amp;epsilon:</span><span class="t"> </span><span class="mf">0.0</span>
<span class="m">5944751508129055/562949953421312</span>
<span class="caret">&gt;</span> <span class="n">a</span><span class="t"> </span><span class="nf">foo:</span><span class="t"> </span><span class="n">b</span><span class="t"> </span><span class="nf">&amp;c:</span><span class="t"> </span><span class="mi">2</span><span class="t"> </span><span class="o"><a href="core.html#definition_:=:">:=</a></span><span class="t"> </span><span class="n">a</span><span class="t"> </span><span class="o"><a href="numbers.html#definition_+:">+</a></span><span class="t"> </span><span class="n">b</span><span class="t"> </span><span class="o"><a href="numbers.html#definition_*:">*</a></span><span class="t"> </span><span class="n">c</span>
<span class="nd">@ok</span>
<span class="caret">&gt;</span> <span class="mi">1</span><span class="t"> </span><span class="nf">foo:</span><span class="t"> </span><span class="mi">2</span>
<span class="mi">5</span>
<span class="caret">&gt;</span> <span class="mi">1</span><span class="t"> </span><span class="nf">foo:</span><span class="t"> </span><span class="mi">2</span><span class="t"> </span><span class="nf">&amp;c:</span><span class="t"> </span><span class="mi">3</span>
<span class="mi">7</span>
</pre></div><p>When the method is evaluated, the name of the optional is bound to its value. Above, <code><span class="n">epsilon</span></code> and <code><span class="n">c</span></code> are provided via the <code><span class="nf">&amp;epsilon:</span><span class="t"> </span><span class="mf">0.0</span></code> and <code><span class="nf">&amp;c:</span><span class="t"> </span><span class="mi">2</span></code> optionals, respectively. Note that an optional role must specify a default value.</p><p>The default value for optionals is actually an expression, which will be evaluated in the method body's context if no value is provided. Therefore, it can use bindings provided by patterns in other roles:

</p><div class="example"><p><em>Example:</em></p><pre class="interaction"><span class="caret">&gt;</span> <span class="n">a</span><span class="t"> </span><span class="nf">foo:</span><span class="t"> </span><span class="n">b</span><span class="t"> </span><span class="nf">&amp;c:</span><span class="t"> </span><span class="p">(</span><span class="n">a</span><span class="t"> </span><span class="o"><a href="numbers.html#definition_+:">+</a></span><span class="t"> </span><span class="n">b</span><span class="p">)</span><span class="t"> </span><span class="o"><a href="core.html#definition_:=:">:=</a></span><span class="t"> </span><span class="p">[</span><span class="n">a</span><span class="p">,</span><span class="t"> </span><span class="n">b</span><span class="p">,</span><span class="t"> </span><span class="n">c</span><span class="p">]</span>
<span class="nd">@ok</span>
<span class="caret">&gt;</span> <span class="mi">1</span><span class="t"> </span><span class="nf">foo:</span><span class="t"> </span><span class="mi">2</span>
<span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="t"> </span><span class="mi">2</span><span class="p">,</span><span class="t"> </span><span class="mi">3</span><span class="p">]</span>
<span class="caret">&gt;</span> <span class="mi">1</span><span class="t"> </span><span class="nf">foo:</span><span class="t"> </span><span class="mi">2</span><span class="t"> </span><span class="nf">&amp;c:</span><span class="t"> </span><span class="mi">4</span>
<span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="t"> </span><span class="mi">2</span><span class="p">,</span><span class="t"> </span><span class="mi">4</span><span class="p">]</span>
</pre></div>



</div>
<div class="section">
  <h2 class="section-header" id="section_redefining">Redefining Methods</h2><p>  </p><p>When defining a method, certain factors are taken into account to determine if you're replacing an already-defined method or just adding another one alongside, with e.g. alternative patterns matched.</p><p>The basic criteria is that the patterns are checked for &quot;equivalence,&quot; and optional arguments are ignored when determining this. Two patterns are equivalent if they are of the same type and the same structure, ignoring names for wildcard matches.</p><p>For example, all of the following are considered equivalent:

</p><div class="highlight"><pre><span class="n">_</span><span class="t">
</span><span class="n">a</span><span class="t">
</span><span class="p">(</span><span class="nf">a:</span><span class="t"> </span><span class="n">_</span><span class="p">)</span><span class="t">
</span><span class="p">(</span><span class="nf">a:</span><span class="t"> </span><span class="n">b</span><span class="p">)</span></pre></div><p>While the following are not:

</p><div class="highlight"><pre><span class="n">_</span><span class="t"> </span><span class="o"><a href="ecosystem.html#definition_.:">.</a></span><span class="t"> </span><span class="n">_</span><span class="t">
</span><span class="p">[</span><span class="n">_</span><span class="p">,</span><span class="t"> </span><span class="n">_</span><span class="p">]</span><span class="t">
</span><span class="o"><a href="ranges.html#definition_...:">...</a></span><span class="t"> </span><span class="n">_</span></pre></div><p>This second group of patterns are all of different types, which match different things. While <code><span class="n">_</span><span class="t"> </span><span class="o"><a href="ecosystem.html#definition_.:">.</a></span><span class="t"> </span><span class="n">_</span></code> and <code><span class="p">[</span><span class="n">_</span><span class="p">,</span><span class="t"> </span><span class="n">_</span><span class="p">]</span></code> both match list values, the lists they match are different (one just requires it to be non-empty, the other requires it to contain two values); thus, they are not equivalent.</p><p>When a method is defined with a message pattern that is equivalent to one already inserted, it replaces it. Incidentally, this is the same for whether you use <code><span class="o"><a href="core.html#definition_:=:">:=</a></span></code> for defining a method or <code><span class="o"><a href="core.html#definition_=:">=</a></span></code> for inserting slots - both are just inserting methods (one as a &quot;responder&quot; and one as a &quot;slot&quot;), so they both replace preexisting definitions the same way.

</p></div>

    </div>
  </body>
</html>
